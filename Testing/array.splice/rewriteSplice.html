<!DOCTYPE html>
<html>
  <head>
    <title>3. write up copyWithin</title>
  </head>
  <body>
    <script src="../../simpleTest.js"></script>
    <script>
      console.groupCollapsed('%cRewriting Methods Step 1 ::: Use Cases', 'color: purple');
      var preassumption = "It is natural that you need to know how a method work before you decide to rewrite it yourself."
      var noDocSpecs = "You don't always have docs and specs for a method";
      var noSrcPf = "You aren't always allowed to access source code and polyfill";
      var useCaseExhaust = "It seems we can only rely on exhaustive exploration of use cases to gain proper understanding of a method."; 
      var how = "However, being literal exhaustive is time costly. So, how to explore use cases sensibly?";
      var strategy0 = "1. postulate with a simple but reasonable hypothesis"
      var strategy1 = "2. explore all sensible use cases extended from the hypothesis"
      var strategy2 = "3. explore sensible value ranges of each arg";
      var strategy3 = "4. starting to write use cases or tests based on the first 3 steps";
      var strategy4 = "5. iterate on the four steps above";

      console.log(preassumption);
      console.log(noDocSpecs);
      console.log(noSrcPf)
      console.log(useCaseExhaust);
      console.log(how);
      console.log(strategy0);
      console.log(strategy1);
      console.log(strategy2);
      console.log(strategy3);
      console.log(strategy4);
      console.groupEnd();

      /* Filling in 1st */
      console.groupCollapsed("%cStep 1 ::: Postulating A Sensible Hypothesis From 4 Tests", "color: purple");
      console.log('Getting a primitive hypothesis from the syntax (The only thing offered to us) ::: var arrDeletedItems = array.splice(start[, deleteCount[, item1[, item2[, ...]]]])');
      console.log('Hypothesis ::: it deletes `deleteCount` number of items from index `start`, and replace with `item1`, `item2` if provided; it returns the deleted items within a new array, and the original array is mutable.');
      console.log('Confirm or update the hypothesis with 4 tests, see what is confirmed below');
      console.log('array ::: an array to be deleted from');
      console.log('arrDeletedItems ::: a returned array with deleted items ');
      console.log('start ::: (required) index to be deleted at (and onward)');
      console.log('deleteCount ::: (optional) num of items to be deleted');
      console.log('item1, item2 ::: (optionals) items to replaced the delted items');
      console.log("Now, we have the hypothesis ready, why can't we start rewriting?");
      console.log('To reproduce the exact functionality of the method, we need to cover all use cases, it means to explore all value ranges of args');
      console.groupEnd();

      tests({
        "test H : [1,2,3,4], 0, 1 (delete value 1)": function(){
          var arrayTest = [1,2,3,4];
          var start = 0; 
          var deleteCount = 1; 
          var item1;
          var item2;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed('test logs');
          console.log('I expect arrDeletedItems to be [1] : ', arrayEq([1], arrDeletedItems));
          console.groupEnd();
        }, 

        "test H : [1,2,3,4], 0, 1 (arrayTest mutable)": function(){
          var arrayTest = [1,2,3,4];
          var start = 0; 
          var deleteCount = 1; 
          var item1;
          var item2;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed('test logs');
          console.log('I expect arrayTest to be [2,3,4] : ', arrayEq([2,3,4], arrayTest));
          console.groupEnd();
        }, 

        "test H : [1,2,3,4], 0, 1 (delete values 3,4)": function(){
          var arrayTest = [1,2,3,4];
          var start = 2; 
          var deleteCount = 2; 
          var item1;
          var item2;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed('test logs');
          console.log('I expect arrDeletedItems to be [3,4] : ', arrayEq([3,4], arrDeletedItems));
          console.groupEnd();
        }, 

        "test H : [1,2,3,4], 0, 1 (delete values 2,3, replaced with undefined)": function(){
          var arrayTest = [1,2,3,4];
          var start = 1; 
          var deleteCount = 2; 
          var item1;
          var item2;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount, item1, item2);
          console.groupCollapsed('test logs');
          console.log('I expect arrDeletedItems to be [2,3] : ', arrayEq([2,3], arrDeletedItems));
          console.log('I expect the arrayTest to be [1,undefined, undefined, 4] : ', arrayEq([1,undefined, undefined, 4], arrayTest));
          console.groupEnd();
        }, 
      })

      console.groupCollapsed('%cBefore Step2 ::: Picking sensible Arrays to test', 'color: purple');
      console.log('[], [0], [1,2] ::: are simpler than [1,2,3] or [1,2,3,4]');
      console.log('But in real practice, [1,2,3] and longer arrays are more common');
      console.log('[1,2,3] ::: should be consided as the simplest but common array, and to be tested first.');
      console.log('[], [0], [1,2] ::: second')
      console.log('[1,,3] ::: sparse array as an edge case is to be tested in the end.');
      console.groupEnd();

      /* Filling in 2nd */
      console.groupCollapsed('%cStep 2 ::: Pondering Sensible Use Cases', 'color: purple');
      console.log('Why ::: When you create a method, you think of use cases first, then the code. For creating or rewriting, We should do the same here.');
      console.log('%cObvious cases ====>', 'color: cyan');
      console.log('1 ::: delete one element');
      console.log('2 ::: delete two elements');
      console.log('3 ::: delete three elements');
      console.log('1-1 ::: delete 1 element and replaced with 1 item');
      console.log('2-2 ::: delete 2 elements and replaced with 2 items');
      console.log('0 ::: do nothing, maybe?');
      console.log('Can not think of other obvious use cases as a method designer');
      console.groupEnd();

      
      /* Filling in 3rd */
      console.groupCollapsed('%cStep 3 ::: Obvious Args Ranges', 'color: cyan');
      console.log('What are the natural arg value ranges to achieve the use cases ');
      console.log('0 <= start <= array.length-1');
      console.log('0 < deleteCount <= array.length - start');
      console.log('item1 can be any type : undefined, null, NaN, number, string, bool, array, object');
      console.groupEnd();
      

      /* Filling in 4th */
      console.groupCollapsed('%cStep 3 ::: Negative Arg Ranges ', 'color: cyan');
      console.log('negative index is common in programming, it should enable `splice` to do the same as the above. yes')
      console.log('-array.length <= start < 0');
      console.log('1 <= deleteCount <= array.length (it is reasonable to expect the same)');
      console.groupEnd();

      console.groupCollapsed('%cStep 3 ::: Edge Arg Ranges ', 'color: cyan');
      console.log('Edge cases ::: unnatural values ranges of args to use');
      console.log('start >= array.length ::: delete nothing');
      console.log('start < -array.length ::: start will be fixed at -array.length');
      console.log('deleteCount > array.length-start ::: deleteCount will be fixed at array.length-start');
      console.log('deleteCount <= 0 ::: delete nothing');
      console.log('delete one, but replace two items ::: replace item1 at idx start and item2 at idx start+1');
      console.log('delete two, but replace one item');
      console.groupEnd();

      



      console.groupCollapsed('%cStep 4 ::: Writing tests and Iteration', 'color: purple');
      console.log('Focusing on array [1,2,3]');
      console.log('Starting to write tests one case by another');
      console.log('Test description includes info on case, arg ranges and values');
      console.log('In the end write one or two tests for each of [1,2], [0], [], [1,,3]');
      console.log('Keep improving on descriptions of cases, arg ranges, and test organizations');
      console.log('Starting to write function from scratch ::: build up one case by another');
      console.log('Debugging and Improving the function until it passes all the tests within each case');
      console.log('Then move on to the next case');
      console.groupEnd();

      /* For simplicity, write tests with combination between delete 1 case, obvious, negative, edge first; and then add delete 2 case onto it  */
      tests({
        "test ::: 1, obvious ::: [1,2,3], 0, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 0;
          var deleteCount = 1;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1]', arrayEq([1],arrDeletedItems));
          console.log('the arrayTest should be [2,3]', arrayEq([2,3],arrayTest));
          console.groupEnd();
        },

        "test ::: 1, obvious ::: [1,2,3], 1, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 1;
          var deleteCount = 1;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [2]', arrayEq([2],arrDeletedItems));
          console.log('the arrayTest should be [1,3]', arrayEq([1,3],arrayTest));
          console.groupEnd();
        },

        "test ::: 1, obvious ::: [1,2,3], 2, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 2;
          var deleteCount = 1;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [3]', arrayEq([3],arrDeletedItems));
          console.log('the arrayTest should be [1,2]', arrayEq([1,2],arrayTest));
          console.groupEnd();
        },

        "test ::: 2, obvious ::: [1,2,3], 0, 2": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 0;
          var deleteCount = 2;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1,2]', arrayEq([1,2],arrDeletedItems));
          console.log('the arrayTest should be [3]', arrayEq([3],arrayTest));
          console.groupEnd();
        },

        "test ::: 2, obvious ::: [1,2,3], 1, 2": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 1;
          var deleteCount = 2;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [2,3]', arrayEq([2,3],arrDeletedItems));
          console.log('the arrayTest should be [1]', arrayEq([1],arrayTest));
          console.groupEnd();
        },


        "test ::: 1, negative ::: [1,2,3], -1, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = -1;
          var deleteCount = 1;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [3]', arrayEq([3],arrDeletedItems));
          console.log('the arrayTest should be [1,2]', arrayEq([1,2],arrayTest));
          console.groupEnd();
        },

        "test ::: 1, negative ::: [1,2,3], -2, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = -2;
          var deleteCount = 1;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [2]', arrayEq([2],arrDeletedItems));
          console.log('the arrayTest should be [1,3]', arrayEq([1,3],arrayTest));
          console.groupEnd();
        },

        "test ::: 1, negative ::: [1,2,3], -3, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = -3;
          var deleteCount = 1;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1]', arrayEq([1],arrDeletedItems));
          console.log('the arrayTest should be [2,3]', arrayEq([2,3],arrayTest));
          console.groupEnd();
        },

        "test ::: 2, negative ::: [1,2,3], -2, 2": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = -2;
          var deleteCount = 2;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [2,3]', arrayEq([2,3],arrDeletedItems));
          console.log('the arrayTest should be [1]', arrayEq([1],arrayTest));
          console.groupEnd();
        },

        "test ::: 2, negative ::: [1,2,3], -3, 2": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = -3;
          var deleteCount = 2;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1,2]', arrayEq([1,2],arrDeletedItems));
          console.log('the arrayTest should be [3]', arrayEq([3],arrayTest));
          console.groupEnd();
        },

        "test ::: 1-1 ::: [1,2,3], 0, 1, 4": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 0;
          var deleteCount = 1;
          var item1 = 4;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount, item1);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1]', arrayEq([1],arrDeletedItems));
          console.log('the arrayTest should be [4,2,3]', arrayEq([4,2,3],arrayTest));
          console.groupEnd();
        },

        "test ::: 0, start >= array.length  ::: [1,2,3], 3, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 3;
          var deleteCount = 1;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be []', arrayEq([],arrDeletedItems));
          console.log('the arrayTest should be [1,2,3]', arrayEq([1,2,3],arrayTest));
          console.groupEnd();
        },

        "test ::: 0, start >= array.length  ::: [1,2,3], 4, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 4;
          var deleteCount = 1;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be []', arrayEq([],arrDeletedItems));
          console.log('the arrayTest should be [1,2,3]', arrayEq([1,2,3],arrayTest));
          console.groupEnd();
        },

        "test ::: 1, start < -array.length  ::: [1,2,3], -4, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = -4;
          var deleteCount = 1;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1]', arrayEq([1],arrDeletedItems));
          console.log('the arrayTest should be [2,3]', arrayEq([2,3],arrayTest));
          console.groupEnd();
        },

        "test ::: 1-2 ::: [1,2,3], 0, 1, 4, 5": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 0;
          var deleteCount = 1;
          var item1 = 4;
          var item2 = 5;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount, item1, item2);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1]', arrayEq([1],arrDeletedItems));
          console.log('the arrayTest should be [4,5,2,3]', arrayEq([4,5,2,3],arrayTest));
          console.groupEnd();
        },

        "test ::: 1-2 ::: [1,2,3], 1, 1, 4, 5": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 1;
          var deleteCount = 1;
          var item1 = 4;
          var item2 = 5;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount, item1, item2);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [2]', arrayEq([2],arrDeletedItems));
          console.log('the arrayTest should be [1,4,5,3]', arrayEq([1,4,5,3],arrayTest));
          console.groupEnd();
        },

        "test ::: 1-2 ::: [1,2,3], 2, 1, 4, 5": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 2;
          var deleteCount = 1;
          var item1 = 4;
          var item2 = 5;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount, item1, item2);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [3]', arrayEq([3],arrDeletedItems));
          console.log('the arrayTest should be [1,2,4,5]', arrayEq([1,2,4,5],arrayTest));
          console.groupEnd();
        },
        "test ::: 2-1 ::: [1,2,3], 0, 2, 4": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 0;
          var deleteCount = 2;
          var item1 = 4;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount, item1);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1,2]', arrayEq([1,2],arrDeletedItems));
          console.log('the arrayTest should be [4,3]', arrayEq([4,3],arrayTest));
          console.groupEnd();
        },

        "test ::: deleteCount > array.length-start  ::: [1,2,3], 0, 4": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 0;
          var deleteCount = 4;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1,2,3]', arrayEq([1,2,3],arrDeletedItems));
          console.log('the arrayTest should be []', arrayEq([],arrayTest));
          console.groupEnd();
        },

        "test ::: deleteCount > array.length-start ::: [1,2,3], 1, 3": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 1;
          var deleteCount = 3;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [2,3]', arrayEq([2,3],arrDeletedItems));
          console.log('the arrayTest should be [1]', arrayEq([1],arrayTest));
          console.groupEnd();
        },

        "test ::: deleteCount > array.length-start ::: [1,2,3], 2, 2": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 2;
          var deleteCount = 2;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [3]', arrayEq([3],arrDeletedItems));
          console.log('the arrayTest should be [1,2]', arrayEq([1,2],arrayTest));
          console.groupEnd();
        },

        "test ::: deleteCount > array.length-start ::: [1,2,3], -1, 2": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = -1;
          var deleteCount = 2;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [3]', arrayEq([3],arrDeletedItems));
          console.log('the arrayTest should be [1,2]', arrayEq([1,2],arrayTest));
          console.groupEnd();
        },

        "test ::: deleteCount <= 0  ::: [1,2,3], 0, 0": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 0;
          var deleteCount = 0;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be []', arrayEq([],arrDeletedItems));
          console.log('the arrayTest should be [1,2,3]', arrayEq([1,2,3],arrayTest));
          console.groupEnd();
        },

        "test ::: deleteCount <= 0  ::: [1,2,3], 0, -1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 0;
          var deleteCount = -1;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be []', arrayEq([],arrDeletedItems));
          console.log('the arrayTest should be [1,2,3]', arrayEq([1,2,3],arrayTest));
          console.groupEnd();
        },

        "test ::: deleteCount <= 0  ::: [1,2,3], 0, -2": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 0;
          var deleteCount = -2;
          // debugger;
          var arrDeletedItems = arrayTest.splice(start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be []', arrayEq([],arrDeletedItems));
          console.log('the arrayTest should be [1,2,3]', arrayEq([1,2,3],arrayTest));
          console.groupEnd();
        },

      });

    </script>
  </body>
</html>