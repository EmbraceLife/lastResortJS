<!DOCTYPE html>
<html>
  <head>
    <title>3. write up copyWithin</title>
  </head>
  <body>
    <script src="../../simpleTest.js"></script>
    <script>
      console.groupCollapsed('%cRewriting Methods Step 1 ::: Use Cases', 'color: purple');
      var preassumption = "It is natural that you need to know how a method work before you can rewrite it yourself."
      var noDocSpecs = "You don't always have docs and specs for a method";
      var noSrcPf = "You aren't always allowed to access source code and polyfill";
      var useCaseExhaust = "It seems we can only rely on exhaustive exploration of use cases to gain proper understanding of a method."; 
      var how = "However, being literal exhaustive is time costly. So, how to explore use cases sensibly?";
      var strategy0 = "1. postulate with a simple but reasonable hypothesis"
      var strategy1 = "2. explore all sensible use cases extended from the hypothesis"
      var strategy2 = "3. explore sensible value ranges of each arg";
      var strategy3 = "4. starting to write use cases or tests based on the first 3 steps";
      var strategy4 = "5. iterate on the four steps above";

      console.log(preassumption);
      console.log(noDocSpecs);
      console.log(noSrcPf)
      console.log(useCaseExhaust);
      console.log(how);
      console.log(strategy0);
      console.log(strategy1);
      console.log(strategy2);
      console.log(strategy3);
      console.log(strategy4);
      console.groupEnd();

      /* Filling in 1st */
      console.groupCollapsed("%cStep 1 ::: Postulating A Sensible Hypothesis From 4 Tests", "color: purple");
      console.log('Getting a primitive hypothesis from the syntax (The only thing offered to us) ::: var arrDeletedItems = array.splice(start[, deleteCount[, item1[, item2[, ...]]]])');
      console.log('Hypothesis ::: it deletes `deleteCount` number of items from index `start`, and replace with `item1`, `item2` if provided; it returns the deleted items within a new array, and the original array is mutable.');
      console.log('Confirm or update the hypothesis with 4 tests, see what is confirmed below');
      console.log('array ::: an array to be deleted from');
      console.log('arrDeletedItems ::: a returned array with deleted items ');
      console.log('start ::: (required) index to be deleted at (and onward)');
      console.log('deleteCount ::: (optional) num of items to be deleted');
      console.log('item1, item2 ::: (optionals) items to replaced the delted items');
      console.log("Now, we have the hypothesis ready, why can't we start rewriting?");
      console.log('To reproduce the exact functionality of the method, we need to cover all use cases, it means to explore all value ranges of args');
      console.groupEnd();

      tests({
        "test H : [1,2,3,4], 0, 1 (delete value 1)": function(){
          var arrayTest = [1,2,3,4];
          var start = 0; 
          var deleteCount = 1; 
          var item1;
          var item2;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed('test logs');
          console.log('I expect arrDeletedItems to be [1] : ', arrayEq([1], arrDeletedItems));
          console.groupEnd();
        }, 

        "test H : [1,2,3,4], 0, 1 (arrayTest mutable)": function(){
          var arrayTest = [1,2,3,4];
          var start = 0; 
          var deleteCount = 1; 
          var item1;
          var item2;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed('test logs');
          console.log('I expect arrayTest to be [2,3,4] : ', arrayEq([2,3,4], arrayTest));
          console.groupEnd();
        }, 

        "test H : [1,2,3,4], 0, 1 (delete values 3,4)": function(){
          var arrayTest = [1,2,3,4];
          var start = 2; 
          var deleteCount = 2; 
          var item1;
          var item2;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed('test logs');
          console.log('I expect arrDeletedItems to be [3,4] : ', arrayEq([3,4], arrDeletedItems));
          console.groupEnd();
        }, 

        /* V6 does not work here, missing value in sparse array has to be handled in the context not right in the end. see V7 */
        "test H : [1,2,3,4], 0, 1 (delete values 2,3, replaced with undefined)": function(){
          var arrayTest = [1,2,3,4];
          var start = 1; 
          var deleteCount = 2; 
          var item1;
          var item2;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount, item1, item2);
          var arrDeletedItems = splice(arrayTest, start, deleteCount, item1, item2);
          console.groupCollapsed('test logs');
          console.log('I expect arrDeletedItems to be [2,3] : ', arrayEq([2,3], arrDeletedItems));
          console.log('I expect the arrayTest to be [1,undefined, undefined, 4] : ', arrayEq([1,undefined, undefined, 4], arrayTest));
          console.groupEnd();
        }, 
      })

      console.groupCollapsed('%cBefore Step2 ::: Picking sensible Arrays to test', 'color: purple');
      console.log('[], [0], [1,2] ::: are simpler than [1,2,3] or [1,2,3,4]');
      console.log('But in real practice, [1,2,3] and longer arrays are more common');
      console.log('[1,2,3] ::: should be consided as the simplest but common array, and to be tested first.');
      console.log('[], [0], [1,2] ::: second')
      console.log('[1,,3] ::: sparse array as an edge case is to be tested in the end.');
      console.groupEnd();

      /* Filling in 2nd */
      console.groupCollapsed('%cStep 2 ::: Pondering Sensible Use Cases', 'color: purple');
      console.log('Why ::: When you create a method, you think of use cases first, then the code. For creating or rewriting, We should do the same here.');
      console.log('1 ::: delete one element');
      console.log('2 ::: delete two elements');
      console.log('3 ::: delete three elements');
      console.log('1-1 ::: delete 1 element and replaced with 1 item');
      console.log('2-2 ::: delete 2 elements and replaced with 2 items');
      console.log('0 ::: delete nothing');
      console.log('0-1 ::: delete nothing and insert one (discoverred in docs)');
      console.log('Can not think of other obvious use cases as a method designer');
      console.groupEnd();

      
      /* Filling in 3rd */
      console.groupCollapsed('%cStep 3 ::: Obvious Args Ranges', 'color: cyan');
      console.log('It is reasonable to expect 0 <= start <= array.length-1');
      console.log('It is reasonable to expect 0 < deleteCount <= array.length - start');
      console.log('item1 could be any type : undefined, null, NaN, number, string, bool, array, object');
      console.groupEnd();
      
      function spliceV1(array, start, deleteCount){
        /* 
        how to directly remove middle items from an array? ====>
        I don't know how.
        A different approach ===>
        1. create two new arrays, arrDeletedItems, arrRemained;
        2. assign arrRemained to array
        */
        var arrDeletedItems = [];
        var arrRemained = [];
        for (i = 0; i < array.length; i++){
          /* 
          How to identify element idx to be deleted ====>
          code ::: if start <= i <= start+deleteCount-1 
          precondition ::: based Obvious Args Ranges
          */
          if (start <= i && i <= start + deleteCount - 1) {
            arrDeletedItems.push(array[i]);
          } else {
            arrRemained.push(array[i]);
          }
          
        }
        /* 
        Approach 1 ::: to change values and length of array 
        code ::: array = arrRemained;
        problem ::: change array's length and values, but also changed reference 
        
        Approach 2 ::: to change values and length of array 
        solution ::: get length to 0, and push arrRemained to array
        code ::: see below
        */
        array.length = 0;
        for (i = 0; i < arrRemained.length; i++) {
          array.push(arrRemained[i]);
        }
        return arrDeletedItems;
      }

      /* Filling in 4th */
      console.groupCollapsed('%cStep 3 ::: Negative Arg Ranges', 'color: cyan');
      console.log('negative index is common in programming.')
      console.log('when -array.length <= start < 0, splice should be able to do the same as above');
      console.groupEnd();

      function spliceV2(array, start, deleteCount){
        /* 
        Convert negative values to positive ===>
        Why ::: because negative value ranges try to provide the same functionality as the positive value ranges 
        */
        if (-array.length <= start && start < 0) {
          start = array.length + start; /* this convert negative start to postive start */
        }
        /* 
        Here we assume deleteCount to be positive. We don't cover deleteCount <= 0 here.
        */
        
        var arrDeletedItems = [];
        var arrRemained = [];
        for (i = 0; i < array.length; i++){
          
          if (start <= i && i <= start + deleteCount - 1) {
            arrDeletedItems.push(array[i]);
          } else {
            arrRemained.push(array[i]);
          }
        }
        
        array.length = 0;
        for (i = 0; i < arrRemained.length; i++) {
          array.push(arrRemained[i]);
        }
        return arrDeletedItems;
      }

      function spliceV3(array, start, deleteCount){

        var oldLen = array.length; /* added for adding new items */
        
        if (-array.length <= start && start < 0) {
          start = array.length + start; 
        }
        
        var arrDeletedItems = [];
        var arrRemained = [];
        for (i = 0; i < array.length; i++){
          
          if (start <= i && i <= start + deleteCount - 1) {
            arrDeletedItems.push(array[i]);
          } else {
            arrRemained.push(array[i]);
          }
        }
        
        array.length = 0;
        for (i = 0; i < arrRemained.length; i++) {
          array.push(arrRemained[i]);
        }

        /* Feature ::: Adding new items to where elements are deleted
        1. add items at the front 
        2. add items at the end 
        3. add items in the middle 
        */
        
        array.length = 0;

        if (!arguments.length > 3){  // no new items added
          for (i = 0; i < arrRemained.length; i++) {
            array.push(arrRemained[i]);
          }
        } else { // there are new items to be added
          var numItems = arguments.length - 3;

          if (start === 0) { // add new items to the front
            for (idxArg = 3; idxArg < 3+numItems; idxArg++) {
              array.push(arguments[idxArg]);
            }

            for (i = 0; i < arrRemained.length; i++) { // add arrRemained to the end
              array.push(arrRemained[i]);
            }

          } else if (start + deleteCount -1 >= oldLen - 1) { // add new items to the end

            for (i = 0; i < arrRemained.length; i++) { // add arrRemained to the end
              array.push(arrRemained[i]);
            }

            for (idxArg = 3; idxArg < 3+numItems; idxArg++) {
              array.push(arguments[idxArg]);
            }

          } else { // add new items in the middle

            for (i = 0; i < start; i++) { // the front part of remained
              array.push(arrRemained[i]); // use pop
            }

            for (idxArg = 3; idxArg < 3+numItems; idxArg++) { // the added items in the middle
              array.push(arguments[idxArg]);
            }

            for (i = start; i < arrRemained.length; i++) { // add the remaining elements in arrRemained
              array.push(arrRemained[start]);
            }
          }
        }
        // the added code to handle new items end here

        return arrDeletedItems;
      }


      console.groupCollapsed('%cStep 3 ::: Edge Arg Ranges ', 'color: cyan');
      console.log('what if (start >= array.length) ==> exp ::: delete nothing');
      console.log('what if (start < -array.length) ==> exp ::: same outcome as if start is to be -array.length');
      console.log('what if (deleteCount > array.length-start) ==> exp ::: same outcome as if deleteCount is fixed at array.length-start');
      console.log('what if (deleteCount <= 0) ==> exp ::: delete nothing');
      console.log('what if (deleteCount === 1 && item1 && item2) ==> exp ::: replace item1 at idx start and item2 at idx start+1');
      console.log('what if (deleteCount === 2 && item1) ==> exp ::: replace element at idx start with item1');
      console.log('what if (deleteCount === 0 && item1) ==> exp ::: no delete, just insert item1 at idx start (Note ::: I missed out this one and only tested it after reading docs)');
      
      console.groupEnd();

      function spliceV4(array, start, deleteCount){

        var oldLen = array.length; /* added for adding new items */

        /* handling when start < -array.length, make start fixed at -oldLen */
        if (start < -oldLen) {
          start = -oldLen;
        }

        if (-oldLen <= start && start < 0) {
          start = oldLen + start; 
        }

        var arrDeletedItems = [];
        var arrRemained = [];
        for (i = 0; i < oldLen; i++){
          
          if (start <= i && i <= start + deleteCount - 1) {
            arrDeletedItems.push(array[i]);
          } else {
            arrRemained.push(array[i]);
          }
        }

        array.length = 0;

        if (!arguments.length > 3){  // no new items added
          for (i = 0; i < arrRemained.length; i++) {
            array.push(arrRemained[i]);
          }
        } else { // there are new items to be added
          var numItems = arguments.length - 3;

          if (start === 0) { // add new items to the front
            for (idxArg = 3; idxArg < 3+numItems; idxArg++) {
              array.push(arguments[idxArg]);
            }

            for (i = 0; i < arrRemained.length; i++) { // add arrRemained to the end
              array.push(arrRemained[i]);
            }

          } else if (start + deleteCount -1 >= oldLen - 1) { // add new items to the end

            for (i = 0; i < arrRemained.length; i++) { // add arrRemained to the end
              array.push(arrRemained[i]);
            }

            for (idxArg = 3; idxArg < 3+numItems; idxArg++) {
              array.push(arguments[idxArg]);
            }

          } else { // add new items in the middle

            for (i = 0; i < start; i++) { // the front part of remained
              array.push(arrRemained[i]); // use pop
            }

            for (idxArg = 3; idxArg < 3+numItems; idxArg++) { // the added items in the middle
              array.push(arguments[idxArg]);
            }

            for (i = start; i < arrRemained.length; i++) { // add the remaining elements in arrRemained
              array.push(arrRemained[start]);
            }
          }
        }
        // the added code to handle new items end here

        return arrDeletedItems;
        }

      function spliceV5(array, start, deleteCount){

        /* V5 ::: handle deleteCount <= 0 specifically */
        if (deleteCount <= 0){ 
          return [];
        }

        var oldLen = array.length; /* added for adding new items */
        
        /* handling when start < -array.length, make start fixed at -oldLen */
        if (start < -oldLen) {
          start = -oldLen;
        }

        if (-oldLen <= start && start < 0) {
          start = oldLen + start; 
        }

        var arrDeletedItems = [];
        var arrRemained = [];
        for (i = 0; i < oldLen; i++){
          
          if (start <= i && i <= start + deleteCount - 1) {
            arrDeletedItems.push(array[i]);
          } else {
            arrRemained.push(array[i]);
          }
        }

        array.length = 0;

        if (!arguments.length > 3){  // no new items added
          for (i = 0; i < arrRemained.length; i++) {
            array.push(arrRemained[i]);
          }
        } else { // there are new items to be added
          var numItems = arguments.length - 3;

          if (start === 0) { // add new items to the front
            for (idxArg = 3; idxArg < 3+numItems; idxArg++) {
              array.push(arguments[idxArg]);
            }

            for (i = 0; i < arrRemained.length; i++) { // add arrRemained to the end
              array.push(arrRemained[i]);
            }

          } else if (start + deleteCount -1 >= oldLen - 1) { // add new items to the end

            for (i = 0; i < arrRemained.length; i++) { // add arrRemained to the end
              array.push(arrRemained[i]);
            }

            for (idxArg = 3; idxArg < 3+numItems; idxArg++) {
              array.push(arguments[idxArg]);
            }

          } else { // add new items in the middle

            for (i = 0; i < start; i++) { // the front part of remained
              array.push(arrRemained[i]); // use pop
            }

            for (idxArg = 3; idxArg < 3+numItems; idxArg++) { // the added items in the middle
              array.push(arguments[idxArg]);
            }

            for (i = start; i < arrRemained.length; i++) { // add the remaining elements in arrRemained
              array.push(arrRemained[start]);
            }
          }
        }
        // the added code to handle new items end here

        return arrDeletedItems;
      }

      function spliceV6(array, start, deleteCount){

        
        if (deleteCount <= 0){ 
          return [];
        }

        var oldLen = array.length; 

        
        if (start < -oldLen) {
          start = -oldLen;
        }

        if (-oldLen <= start && start < 0) {
          start = oldLen + start; 
        }

        var arrDeletedItems = [];
        var arrRemained = [];
        for (i = 0; i < oldLen; i++){
          
          if (start <= i && i <= start + deleteCount - 1) {
            arrDeletedItems.push(array[i]);
          } else {
            arrRemained.push(array[i]);
          }
        }

        array.length = 0;

        if (!arguments.length > 3){  // no new items added
          for (i = 0; i < arrRemained.length; i++) {
            array.push(arrRemained[i]);
          }
        } else { // there are new items to be added
          var numItems = arguments.length - 3;

          if (start === 0) { // add new items to the front
            for (idxArg = 3; idxArg < 3+numItems; idxArg++) {
              array.push(arguments[idxArg]);
            }

            for (i = 0; i < arrRemained.length; i++) { // add arrRemained to the end
              array.push(arrRemained[i]);
            }

          } else if (start + deleteCount -1 >= oldLen - 1) { // add new items to the end

            for (i = 0; i < arrRemained.length; i++) { // add arrRemained to the end
              array.push(arrRemained[i]);
            }

            for (idxArg = 3; idxArg < 3+numItems; idxArg++) {
              array.push(arguments[idxArg]);
            }

          } else { // add new items in the middle

            for (i = 0; i < start; i++) { // the front part of remained
              array.push(arrRemained[i]); // use pop
            }

            for (idxArg = 3; idxArg < 3+numItems; idxArg++) { // the added items in the middle
              array.push(arguments[idxArg]);
            }

            for (i = start; i < arrRemained.length; i++) { // add the remaining elements in arrRemained
              array.push(arrRemained[start]);
            }
          }
        }
        
        /* V6 ::: dealing with missing values */
        for (i in arrDeletedItems) {
          if (arrDeletedItems[i] === undefined) {
            delete arrDeletedItems[i];
          }
        }

        for (i in array) {
          if (array[i] === undefined) {
            delete array[i];
          }
        }

        return arrDeletedItems;
        }

      
      function spliceV7(array, start, deleteCount){

        
        if (deleteCount <= 0){ 
          return [];
        }

        var oldLen = array.length; 


        if (start < -oldLen) {
          start = -oldLen;
        }

        if (-oldLen <= start && start < 0) {
          start = oldLen + start; 
        }

        var arrDeletedItems = [];
        var arrRemained = [];
        for (i = 0; i < oldLen; i++){
          
          if (start <= i && i <= start + deleteCount - 1) {
            arrDeletedItems.push(array[i]);
          } else {
            arrRemained.push(array[i]);
          }
        }

        array.length = 0;

        if (!(arguments.length > 3)){  // no new items added
          for (i = 0; i < arrRemained.length; i++) {
            // array.push(arrRemained[i]);
            if (arrRemained[i] !== undefined){/* V7 */

              array[i] = arrRemained[i];
            }
          }
        } else { // there are new items to be added
          var numItems = arguments.length - 3;

          if (start === 0) { // add new items to the front
            for (idxArg = 3; idxArg < 3+numItems; idxArg++) {
              array.push(arguments[idxArg]);
            }

            var clen = array.length;/* V7 */
            for (i = 0; i < arrRemained.length; i++) { // add arrRemained to the end
              
              if (arrRemained[i] !== undefined){/* V7 */
                array[clen+i] = arrRemained[i];
              }
            }

          } else if (start + deleteCount -1 >= oldLen - 1) { // add new items to the end

            for (i = 0; i < arrRemained.length; i++) { // add arrRemained to the end
            //   array.push(arrRemained[i]);
            // }
              if (arrRemained[i] !== undefined){/* V7 */
                array[i] = arrRemained[i];
              }
            }

            for (idxArg = 3; idxArg < 3+numItems; idxArg++) {
              array.push(arguments[idxArg]);
            }

          } else { // add new items in the middle

            for (i = 0; i < start; i++) { // the front part of remained
              // array.push(arrRemained[i]); // use pop
              if (arrRemained[i] !== undefined){/* V7 */
                array[i] = arrRemained[i];
              }
            }

            for (idxArg = 3; idxArg < 3+numItems; idxArg++) { // the added items in the middle
              array.push(arguments[idxArg]);
            }

            var eLen = array.length;
            for (i = 0; i < arrRemained.length - start; i++) { // add the remaining elements in arrRemained
              // array.push(arrRemained[start]);
              if (arrRemained[i+start] !== undefined){/* V7 */
                array[i+eLen] = arrRemained[i+start];
              }
            }
          }
        }

        /* V6 ::: dealing with missing values */
        for (i in arrDeletedItems) {
          if (arrDeletedItems[i] === undefined) {
            delete arrDeletedItems[i];
          }
        }

        // for (i in array) {
        //   if (array[i] === undefined) {
        //     delete array[i];
        //   }
        // }

        return arrDeletedItems;
      }

      /* V7 ::: can't distinguish intentional missing value and undefined value inside array; V8 ::: a new approach to treat missing value */
      function spliceV8(array, start, deleteCount){

        
        if (deleteCount <= 0){ 
          return [];
        }


        var oldLen = array.length; 


        if (start < -oldLen) {
          start = -oldLen;
        }

        if (-oldLen <= start && start < 0) {
          start = oldLen + start; 
        }

        /* V8 : replace missing values with string 'missing' */
        for (i = 0; i < array.length; i++) {
          if (!array.hasOwnProperty(i)){
            array[i] = 'missing';
          }
        }

        var arrDeletedItems = [];
        var arrRemained = [];
        for (i = 0; i < oldLen; i++){
          
          if (start <= i && i <= start + deleteCount - 1) {
            arrDeletedItems.push(array[i]);
          } else {
            arrRemained.push(array[i]);
          }
        }

        array.length = 0;

        if (!(arguments.length > 3)){  // no new items added
          for (i = 0; i < arrRemained.length; i++) {
            array.push(arrRemained[i]);
            // if (arrRemained[i] !== undefined){/* V7 */

            //   array[i] = arrRemained[i];
            // }
          }
        } else { // there are new items to be added
          var numItems = arguments.length - 3;

          if (start === 0) { // add new items to the front
            for (idxArg = 3; idxArg < 3+numItems; idxArg++) {
              array.push(arguments[idxArg]);
            }

            // var clen = array.length;/* V7 */
            for (i = 0; i < arrRemained.length; i++) { // add arrRemained to the end
              
              // if (arrRemained[i] !== undefined){/* V7 */
              //   array[clen+i] = arrRemained[i];
              // }
              array.push(arrRemained[i]);
            }

          } else if (start + deleteCount -1 >= oldLen - 1) { // add new items to the end

            for (i = 0; i < arrRemained.length; i++) { // add arrRemained to the end
              array.push(arrRemained[i]);
            // }
              // if (arrRemained[i] !== undefined){/* V7 */
              //   array[i] = arrRemained[i];
              // }
            }

            for (idxArg = 3; idxArg < 3+numItems; idxArg++) {
              array.push(arguments[idxArg]);
            }

          } else { // add new items in the middle

            for (i = 0; i < start; i++) { // the front part of remained
              array.push(arrRemained[i]); 
              // if (arrRemained[i] !== undefined){/* V7 */
              //   array[i] = arrRemained[i];
              // }
            }

            for (idxArg = 3; idxArg < 3+numItems; idxArg++) { // the added items in the middle
              array.push(arguments[idxArg]);
            }

            // var eLen = array.length;
            for (i = start; i < arrRemained.length; i++) { // add the remaining elements in arrRemained
              array.push(arrRemained[i]);
              // if (arrRemained[i+start] !== undefined){/* V7 */
              //   array[i+eLen] = arrRemained[i+start];
              // }
            }
          }
        }

        /* V6 ::: dealing with missing values */
        for (i in arrDeletedItems) {
          if (arrDeletedItems[i] === "missing") {
            delete arrDeletedItems[i];
          }
        }

        for (i in array) {
          if (array[i] === "missing") {
            delete array[i];
          }
        }

        return arrDeletedItems;
        }



      console.groupCollapsed('%cStep 4 ::: Writing tests and Iteration', 'color: purple');
      console.log('4.1. Focusing on array [1,2,3], and start to write tests on case 1 (delete 1 element) with all arg ranges');
      console.log('4.2. Built on 4.1, write tests on case 2 (delete 2 elements), and then case 3 (...) and so on');
      console.log('4.3 Test description should specify info on case, arg ranges and values');
      console.log('4.4 In the end write one or two tests for each of [1,2], [0], [], [1,,3]');
      console.log('4.i Keep improving on descriptions of cases, arg ranges, and test organizations');
      console.log('4.5 Starting to write function from scratch, building up one case by another');
      console.log('4.i Debugging and Improving the function until it passes all the tests within each case');
      console.log('4.i adding new tests when needed along the way, try out multi-args combinations');
      console.log('4.6 Then move on to the next case');
      console.log('4.7 when function is rewritten and refactored, start to read docs/specs/polyfill');
      console.log('4.8 debug the polyfill to learn how they are written the way they do');
      console.groupEnd();

      /* For simplicity, write tests with combination between delete 1 case, obvious, negative, edge first; and then add delete 2 case onto it  */
      tests({
        "test (passed) ::: 1, obvious ::: [1,2,3], 0, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 0;
          var deleteCount = 1;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1]', arrayEq([1],arrDeletedItems));
          console.log('the arrayTest should be [2,3]', arrayEq([2,3],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 1, obvious ::: [1,2,3], 1, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 1;
          var deleteCount = 1;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [2]', arrayEq([2],arrDeletedItems));
          console.log('the arrayTest should be [1,3]', arrayEq([1,3],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 1, obvious ::: [1,2,3], 2, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 2;
          var deleteCount = 1;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [3]', arrayEq([3],arrDeletedItems));
          console.log('the arrayTest should be [1,2]', arrayEq([1,2],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 2, obvious ::: [1,2,3], 0, 2": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 0;
          var deleteCount = 2;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1,2]', arrayEq([1,2],arrDeletedItems));
          console.log('the arrayTest should be [3]', arrayEq([3],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 2, obvious ::: [1,2,3], 1, 2": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 1;
          var deleteCount = 2;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [2,3]', arrayEq([2,3],arrDeletedItems));
          console.log('the arrayTest should be [1]', arrayEq([1],arrayTest));
          console.groupEnd();
        },

        /* the spliceV1 function failed here. The next version spliceV2 will consider negative value ranges */
        "test (passed) ::: 1, negative ::: [1,2,3], -1, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = -1;
          var deleteCount = 1;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [3]', arrayEq([3],arrDeletedItems));
          console.log('the arrayTest should be [1,2]', arrayEq([1,2],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 1, negative ::: [1,2,3], -2, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = -2;
          var deleteCount = 1;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [2]', arrayEq([2],arrDeletedItems));
          console.log('the arrayTest should be [1,3]', arrayEq([1,3],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 1, negative ::: [1,2,3], -3, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = -3;
          var deleteCount = 1;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1]', arrayEq([1],arrDeletedItems));
          console.log('the arrayTest should be [2,3]', arrayEq([2,3],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 2, negative ::: [1,2,3], -2, 2": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = -2;
          var deleteCount = 2;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [2,3]', arrayEq([2,3],arrDeletedItems));
          console.log('the arrayTest should be [1]', arrayEq([1],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 2, negative ::: [1,2,3], -3, 2": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = -3;
          var deleteCount = 2;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1,2]', arrayEq([1,2],arrDeletedItems));
          console.log('the arrayTest should be [3]', arrayEq([3],arrayTest));
          console.groupEnd();
        },

        /* spliceV2 is not set for replace with new items, we need to write up spliceV3 */
        "test (passed) ::: 1-1 ::: [1,2,3], 0, 1, 4": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 0;
          var deleteCount = 1;
          var item1 = 4;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount, item1);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1]', arrayEq([1],arrDeletedItems));
          console.log('the arrayTest should be [4,2,3]', arrayEq([4,2,3],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 1-1 ::: [1,2,3], 1, 1, 4": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 1;
          var deleteCount = 1;
          var item1 = 4;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount, item1);
          var arrDeletedItems = splice(arrayTest, start, deleteCount, item1);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [2]', arrayEq([2],arrDeletedItems));
          console.log('the arrayTest should be [1,4,3]', arrayEq([1,4,3],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 1-1 ::: [1,2,3], 2, 1, 4": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 2;
          var deleteCount = 1;
          var item1 = 4;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount, item1);
          var arrDeletedItems = splice(arrayTest, start, deleteCount, item1);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [3]', arrayEq([3],arrDeletedItems));
          console.log('the arrayTest should be [1,2,4]', arrayEq([1,2,4],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 2-2 ::: [1,2,3], 0, 2, 4, 5": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 0;
          var deleteCount = 2;
          var item1 = 4;
          var item2 = 5;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount, item1, item2);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1,2]', arrayEq([1,2],arrDeletedItems));
          console.log('the arrayTest should be [4,5,3]', arrayEq([4,5,3],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 2-2 ::: [1,2,3], 1, 2, 4, 5": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 1;
          var deleteCount = 2;
          var item1 = 4;
          var item2 = 5;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount, item1, item2);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [2,3]', arrayEq([2,3],arrDeletedItems));
          console.log('the arrayTest should be [1,4,5]', arrayEq([1,4,5],arrayTest));
          console.groupEnd();
        },

        /* spliceV3 for new items still works for this edge case */
        "test (passed) ::: 0, start >= array.length  ::: [1,2,3], 3, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 3;
          var deleteCount = 1;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be []', arrayEq([],arrDeletedItems));
          console.log('the arrayTest should be [1,2,3]', arrayEq([1,2,3],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 0, start >= array.length  ::: [1,2,3], 4, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 4;
          var deleteCount = 1;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be []', arrayEq([],arrDeletedItems));
          console.log('the arrayTest should be [1,2,3]', arrayEq([1,2,3],arrayTest));
          console.groupEnd();
        },

        /* spliceV3 for new items does not work here. spliceV4 is needed to deal with situations here */
        "test (passed) ::: 1, start < -array.length  ::: [1,2,3], -4, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = -4;
          var deleteCount = 1;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1]', arrayEq([1],arrDeletedItems));
          console.log('the arrayTest should be [2,3]', arrayEq([2,3],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 1, start < -array.length  ::: [1,2,3], -5, 1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = -5;
          var deleteCount = 1;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1]', arrayEq([1],arrDeletedItems));
          console.log('the arrayTest should be [2,3]', arrayEq([2,3],arrayTest));
          console.groupEnd();
        },

        /* spliceV4 still works */
        "test (passed) ::: 1-2 ::: [1,2,3], 0, 1, 4, 5": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 0;
          var deleteCount = 1;
          var item1 = 4;
          var item2 = 5;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount, item1, item2);
          var arrDeletedItems = splice(arrayTest, start, deleteCount, item1, item2);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1]', arrayEq([1],arrDeletedItems));
          console.log('the arrayTest should be [4,5,2,3]', arrayEq([4,5,2,3],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 1-2 ::: [1,2,3], 1, 1, 4, 5": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 1;
          var deleteCount = 1;
          var item1 = 4;
          var item2 = 5;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount, item1, item2);
          var arrDeletedItems = splice(arrayTest, start, deleteCount, item1, item2);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [2]', arrayEq([2],arrDeletedItems));
          console.log('the arrayTest should be [1,4,5,3]', arrayEq([1,4,5,3],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 1-2 ::: [1,2,3], 2, 1, 4, 5": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 2;
          var deleteCount = 1;
          var item1 = 4;
          var item2 = 5;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount, item1, item2);
          var arrDeletedItems = splice(arrayTest, start, deleteCount, item1, item2);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [3]', arrayEq([3],arrDeletedItems));
          console.log('the arrayTest should be [1,2,4,5]', arrayEq([1,2,4,5],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 2-1 ::: [1,2,3], 0, 2, 4": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 0;
          var deleteCount = 2;
          var item1 = 4;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount, item1);
          var arrDeletedItems = splice(arrayTest, start, deleteCount, item1);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1,2]', arrayEq([1,2],arrDeletedItems));
          console.log('the arrayTest should be [4,3]', arrayEq([4,3],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 2-1 ::: [1,2,3], 1, 2, 4": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 1;
          var deleteCount = 2;
          var item1 = 4;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount, item1);
          var arrDeletedItems = splice(arrayTest, start, deleteCount, item1);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [2,3]', arrayEq([2,3],arrDeletedItems));
          console.log('the arrayTest should be [1,4]', arrayEq([1,4],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 3, deleteCount > array.length-start  ::: [1,2,3], 0, 4": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 0;
          var deleteCount = 4;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1,2,3]', arrayEq([1,2,3],arrDeletedItems));
          console.log('the arrayTest should be []', arrayEq([],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 2, deleteCount > array.length-start ::: [1,2,3], 1, 3": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 1;
          var deleteCount = 3;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [2,3]', arrayEq([2,3],arrDeletedItems));
          console.log('the arrayTest should be [1]', arrayEq([1],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 1, deleteCount > array.length-start ::: [1,2,3], 2, 2": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 2;
          var deleteCount = 2;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [3]', arrayEq([3],arrDeletedItems));
          console.log('the arrayTest should be [1,2]', arrayEq([1,2],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 1, neg, deleteCount > array.length-start ::: [1,2,3], -1, 2": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = -1;
          var deleteCount = 2;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [3]', arrayEq([3],arrDeletedItems));
          console.log('the arrayTest should be [1,2]', arrayEq([1,2],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 2, neg, deleteCount > array.length-start ::: [1,2,3], -2, 3": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = -2;
          var deleteCount = 3;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [2,3]', arrayEq([2,3],arrDeletedItems));
          console.log('the arrayTest should be [1]', arrayEq([1],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 0, deleteCount <= 0  ::: [1,2,3], 0, 0": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 0;
          var deleteCount = 0;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be []', arrayEq([],arrDeletedItems));
          console.log('the arrayTest should be [1,2,3]', arrayEq([1,2,3],arrayTest));
          console.groupEnd();
        },

        /* spliceV4 does not work for this case. I don't know why exactly. But a simple fix is to handle deleteCount <= 0 specifically in spliceV5 */
        "test (passed) ::: 0, deleteCount <= 0  ::: [1,2,3], 1, -1": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 1;
          var deleteCount = -1;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be []', arrayEq([],arrDeletedItems));
          console.log('the arrayTest should be [1,2,3]', arrayEq([1,2,3], arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: 0, deleteCount <= 0  ::: [1,2,3], 2, -2": function(){
          // fail();
          var arrayTest = [1,2,3];
          var start = 2;
          var deleteCount = -2;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be []', arrayEq([],arrDeletedItems));
          console.log('the arrayTest should be [1,2,3]', arrayEq([1,2,3],arrayTest));
          console.groupEnd();
        },

        /* new use case discovered when reading MDN docs */
        "test (passed) ::: 0-1, deleteCount <= 0 ::: [1,3,4], 1, 0, 2": function(){
          var arrayTest = [1,3,4];
          var start = 1; 
          var deleteCount = 0;
          var item1 = 2;
          debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount, item1);
          var arrDeletedItems = splice(arrayTest, start, deleteCount, item1);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be []', arrayEq([],arrDeletedItems));
          console.log('the arrayTest should be [1,2,3,4]', arrayEq([1,2,3,4],arrayTest));
          console.groupEnd();
        },
      

        "test (passed) ::: [1,2], 0, -1": function(){
          // fail();
          var arrayTest = [1,2];
          var start = 0;
          var deleteCount = -1;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be []', arrayEq([],arrDeletedItems));
          console.log('the arrayTest should be [1,2]', arrayEq([1,2],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: [], 0, -1": function(){
          // fail();
          var arrayTest = [];
          var start = 0;
          var deleteCount = -1;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be []', arrayEq([],arrDeletedItems));
          console.log('the arrayTest should be []', arrayEq([],arrayTest));
          console.groupEnd();
        },

        /* spliceV5 does not work here. We need to convert undefined into missing or empty in spliceV6 */
        "test (passed) ::: [1,,3], 0, 2": function(){
          // fail();
          var arrayTest = [1,,3];
          var start = 0;
          var deleteCount = 2;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1,,]', arrayEq([1,,],arrDeletedItems));
          console.log('the arrayTest should be [3]', arrayEq([3],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: [1,,3], 0, 1": function(){
          // fail();
          var arrayTest = [1,,3];
          var start = 0;
          var deleteCount = 1;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1]', arrayEq([1],arrDeletedItems));
          console.log('the arrayTest should be [,3]', arrayEq([,3],arrayTest));
          console.groupEnd();
        },

        "test (passed) ::: [1,,3], 0, 1, 4, 5": function(){
          // fail();
          var arrayTest = [1,,3];
          var start = 0;
          var deleteCount = 1;
          var item1 = 4;
          var item2 = 5;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount, item1, item2);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [1]', arrayEq([1],arrDeletedItems));
          console.log('the arrayTest should be [4,5,,3]', arrayEq([4,5,,3],arrayTest));
          console.groupEnd();
        },

        /* spliceV6 does not work for the 3rd test in the Hypothesis section. I wrote up V7. In the process, I realized a better way to solve the problem, there comes V8 */
        "test (passed) ::: [1,,3,,5], 2, 1, 4, 5": function(){
          // fail();
          var arrayTest = [1,,3,,5];
          var start = 2;
          var deleteCount = 1;
          var item1 = 4;
          var item2 = 5;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount, item1, item2);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [3]', arrayEq([3],arrDeletedItems));
          console.log('the arrayTest should be [1,,4,5,,5]', arrayEq([1,,4,5,,5],arrayTest));
          console.groupEnd();
        },
      
        "test (passed) ::: [1,undefined,3,,5], 2, 1, undefined, 5": function(){
          // fail();
          var arrayTest = [1,undefined,3,,5];
          var start = 2;
          var deleteCount = 1;
          var item1 = undefined;
          var item2 = 5;
          // debugger;
          // var arrDeletedItems = arrayTest.splice(start, deleteCount);
          var arrDeletedItems = splice(arrayTest, start, deleteCount, item1, item2);
          console.groupCollapsed("test logs");
          console.log('the arrDeletedItems should be [3]', arrayEq([3],arrDeletedItems));
          console.log('the arrayTest should be [1,undefined,undefined,5,,5]', arrayEq([1,undefined,undefined,5,,5], arrayTest));
          console.groupEnd();
        },
      
      
      });

      /* Finally version with comments, further refactor can be done. */
      function splice(array, start, deleteCount){

        /* handle edge case specifically */
        if (deleteCount <= 0 && arguments.length === 3){ 
          return [];
        }

        var oldLen = array.length; 

        /* handle edge case specifically */
        if (start < -oldLen) {
          start = -oldLen;
        }

        /* convert negative start to positive */
        if (-oldLen <= start && start < 0) {
          start = oldLen + start; 
        }

        /* handle missing values in array, (added items won't be missing values by default) */
        for (i = 0; i < array.length; i++) {
          if (!array.hasOwnProperty(i)){
            array[i] = 'missing';
          }
        }

        /* save deleted items and remained items into two seperate arrays */
        var arrDeletedItems = [];
        var arrRemained = [];
        for (i = 0; i < oldLen; i++){
          
          if (start <= i && i <= start + deleteCount - 1) {
            arrDeletedItems.push(array[i]);
          } else {
            arrRemained.push(array[i]);
          }
        }

        /* remove everything in array */
        array.length = 0;

        /* when no new items to be replaced or added */
        if (!(arguments.length > 3)){  // no new items added
          for (i = 0; i < arrRemained.length; i++) {
            array.push(arrRemained[i]);
            
          }
        } else { 
          /* when there are new items to be added */

          var numItems = arguments.length - 3;

          /* when adding new items to the front */
          if (start === 0) { 
            for (idxArg = 3; idxArg < 3+numItems; idxArg++) {
              array.push(arguments[idxArg]);
            }

            for (i = 0; i < arrRemained.length; i++) { 
              array.push(arrRemained[i]);
            }

            /* when adding new items to the end */
          } else if (start + deleteCount -1 >= oldLen - 1) { 

            for (i = 0; i < arrRemained.length; i++) { /* put arrRemained in the front */
              array.push(arrRemained[i]);
            }

            for (idxArg = 3; idxArg < 3+numItems; idxArg++) {/* put new items in the end */
              array.push(arguments[idxArg]);
            }

            /* add new items in the middle */
          } else {  

            for (i = 0; i < start; i++) { /* the front part of arrRemained */
              array.push(arrRemained[i]); 
            }

            for (idxArg = 3; idxArg < 3+numItems; idxArg++) { /* put the new items in the middle */
              array.push(arguments[idxArg]);
            }

            for (i = start; i < arrRemained.length; i++) { /*  put the remaining elements in arrRemained to the end */
              array.push(arrRemained[i]);
              
            }
          }
        }

        /* handling missing values stored in arrDeletedItems */
        for (i in arrDeletedItems) {
          if (arrDeletedItems[i] === "missing") {
            delete arrDeletedItems[i];
          }
        }

        /* handling missing values stored in array */
        for (i in array) {
          if (array[i] === "missing") {
            delete array[i];
          }
        }

        return arrDeletedItems;
        }


    </script>
  </body>
</html>