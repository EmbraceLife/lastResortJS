<!DOCTYPE html>
<html>
  <head>
    <title>Library System</title>
  </head>
  <body>
    <script>

    /* Function approach vs IIFE approach ::: no difference except, the first has to save the function in the global  */

    debugger;
    /* Approach 1 : create a func and run the func (rather than IIFE) */
    function enclosingFunc1(){/* enclosingFunc1 can hide many variables inside itself, but can't hide itself */
      var libraryStorage = {};

      function librarySystem(libraryName, callback){
        if (arguments.length > 1){
          libraryStorage[libraryName] = callback();
        } else { 
          return libraryStorage[libraryName];
        }
      }

      window.librarySystem1 = librarySystem; /* inside enclosingFunc1, it can choose to throw a variable to the global */

      /* although libraryStorage is not in global nor in local, but stored in enclosingFunc1, librarySystem1 can manipulate it freely */

      /* Also libraryStorage in enclosingFunc1 and enclosingFunc2 are totally separated and independent */

    };  
    enclosingFunc1();
    librarySystem1("sandwich1", function(){
      return {"this is sandwich1": function(){},}
    });
    var lib1 = librarySystem1("sandwich1");
    

    /* approach 2: use IIFE */
    (function enclosingFunc2(){/* enclosingFunc2 can hide everything from global including itself */
      var libraryStorage = {};

      function librarySystem(libraryName, callback){
        if (arguments.length > 1){/* save the library written in callback into libraryStorage */
          libraryStorage[libraryName] = callback(); /* execution of callback returns the library written inside callback */
        } else { /* if just 1 arg */
          return libraryStorage[libraryName]; /* return the library stored under libraryName in libraryStorage */
        }
      }

      
      window.librarySystem2 = librarySystem; /* inside enclosingFunc1, it can choose to throw a variable to the global */

      /* although libraryStorage is not in global nor in local, but stored in enclosingFunc2, librarySystem2 can manipulate it freely */
    })();  

    librarySystem2("sandwich2", function(){
      return {"this is sandwich2": function(){},}
    });
    var lib2 = librarySystem2("sandwich2");
      
    </script>
  </body>
</html>